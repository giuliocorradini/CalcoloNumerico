# Fattorizzazione QR

A è una matrice quadrata di dimensioni n. Sotto l'ipotesi che sia nonsingolare, allora esiste una matrice
ortogonale Q e una matrice triangolare superiore nonsingolare R tale che:

$$A = QR$$

Se Q è ortogonale allora $Q^T = Q^{-1}$, inoltre $Q\ Q^T = Q^T\ Q = I$

Posso dimostrare questo teorema con vari metodi: con trasformazioni elementari di Householder, di Givens,
con il procedimento Gram-Schmidt oppure per pavimentazione.

## Trasformazioni di Householder

Dato un vettore colonna $v \in \mathbb{R}^n$ con $v \ne 0$, definiamo la trasformazione elementare di Householder
associata a v la matrice:

$$U = I - \frac{1}{\alpha}vv^T$$

dove

$$\alpha = \frac{1}{2}||v||^2_2$$

(ricordiamo che la norma 2 al quadrato è $v_1^2 + v_2^2 + \dots + v_n^2$).

### Matrice U

$vv^T$ è una matrice siffatta

$$
\begin{pmatrix} v_{1}^2 & v_1v_2 & \dots & v_1v_n \\ v_1v_2 & v_2^2 & \dots & v_2v_n \\ \vdots & \vdots & \ddots & \vdots & \\v_1v_n & v_2v_n & \dots & v_n^2 \end{pmatrix}
$$

### Simmetria

Per proprietà commutativa della moltiplicazione su numeri reali, la matrice è simmetrica $(vv^T)^T = vv^T$.

Dimostrazione: $U^T = (I - \frac{1}{\alpha}vv^T)^T = I^T - \frac{1}{\alpha}(vv^T)^T = U$.

### Ortogonalità

Devo dimostrare $U^TU = UU^T$.

$$U^TU = UU$$

$$= (I - \frac{1}{\alpha}vv^T)(I - \frac{1}{\alpha}vv^T)$$

$$= I - I \frac{1}{\alpha}vv^T - \frac{1}{\alpha}vv^T I + \frac{1}{\alpha^2} v\ v^Tv\ v^T = \dots$$

ma $v^tv = ||v||^2 = 2\alpha$, quindi $\dots = I - 2 \frac{1}{\alpha}vv^T + \frac{2}{\alpha} vv^T = I$.

## Osservazione

Voglio calcolare $z = Uy$, dove U è la trasformazione elementare di Householder.

La prima opzione è calcolare U come $I - \frac{1}{\alpha} vv^T$ e poi
calcolo z = Uy.

La seconda opzione è fare un po' di algebra, facendo diventare
$z = y - \frac{1}{\alpha}vv^Ty$.
Prima eseguo $v^Ty$, che è un prodotto riga per colonna, che mi ritorna uno scalare.

L'alternativa 2 è computazionalmente più conveniente:

- con la prima devo calcolare $n^2$ prodotti, poi $\frac{n^2}{2}$ prodotti (con uno scalare) e infine $n^2$ somme.
$\Omega(n^2)$.

- con la seconda ho $n$ prodotti, poi ho $n$ differenze. $\Omega(n)$.

## Proprietà sigma

### Idea

Voglio eliminare gli elementi del triangolo inferiore di A usando le trasformazioni elementari di Householder invece
di quelle di Gauss.

Scegliendo opportunamente U, possiamo trovare un valore $\sigma$ tale che $Uz = - \sigma e_1$.

### Costruzione

Prendiamo uno $z \in \mathbb{R}^n \setminus \{0\}$. Scelgo $v = z + \sigma e_1$, dove $e_1$ è la prima colonna della
matrice identità di ordine n.

$$\sigma = ||z||_2 = \sqrt{z_1^2 + z_2^2 + \dots + z_n^2}$$

Che ci rappresenta la distanza in $\mathbb{R}^n$ del vettore z dall'origine.

### Dimostrazione

Calcoliamo $\alpha$

$$
\alpha = \frac{1}{2}||v||^2
= \frac{1}{2}v^Tv
= \frac{1}{2}(z + \sigma e_1)^T (z + \sigma e_1)
= \frac{1}{2}(z^T + \sigma e_1^T) (z + \sigma e_1)
$$

con la proprietà distributiva sviluppo il prodotto

$$
\frac{1}{2} (z^Tz + \sigma z e_1 + \sigma e_1^T z + \sigma^2 e_1^T e_1)

= \frac{1}{2} (||z||^2 + \sigma z_1 + \sigma z_1 + \sigma^2 ||e_1||^2)

= \frac{1}{2} (||z||^2 + 2 \sigma z_1 + \sigma^2)

= \frac{1}{2} (\sigma^2 + 2 \sigma z_1 + \sigma^2)

= \frac{1}{2} 2 (\sigma^2 + \sigma z_1)

= \sigma^2 + \sigma z_1
$$

Calcoliamo Uz:

$$
= (I - \frac{1}{\alpha} vv^T) z
= [I - \frac{1}{\alpha} (z + \sigma e_1) (z + \sigma e_1)^T] z
= Iz - \frac{1}{\alpha} (z + \sigma e_1) (z + \sigma e_1)^T z
= Iz - \frac{1}{\alpha} (z + \sigma e_1) (z^T + \sigma e_1^T) z
= Iz - \frac{1}{\alpha} (z + \sigma e_1) (z^Tz + \sigma e_1^T z)
= Iz - \frac{1}{\alpha} (z + \sigma e_1) (\sigma^2 + \sigma z_1)
$$

a questo punto sostituisco $(\sigma^2 + \sigma z_1)$ con $\alpha$

$$
= Iz - (z + \sigma e_1) = z - z - \sigma e_1 = - \sigma e_1
$$

che ha queste fattezze

$$
- \sigma e_1 = \begin{pmatrix} -\sigma \\ 0 \\ \vdots \\ 0 \end{pmatrix}
$$

## La fattorizzazione

Al primo passaggio calcolo la trasfomazione di Householder $U_1$ su $v_1 = a^{(1)} + \sigma_1 e_1$.

$U_1A = (U_1a_1, U_2a_2, \dots, U_n,a_n)$.
