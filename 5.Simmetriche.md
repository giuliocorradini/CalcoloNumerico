# Matrici simmetriche

Una matrice è simmetrica se $A = A^T$.

Possiamo sfruttare questa proprietà per fare una fattorizzazione più veloce con Gauss.

## Teorema di fattorizzazione di Gauss per matrici simmetriche

Se A è simmetrica e i minori principali sono diversi da 0 (come l'hp del teorema di fattorizzazione
per matrici generiche), allora esistono una matrice L triangolare inferiore con diagonale unitaria
e una matrice diagonale D con elementi diagonali diversi da zero tali che:

$A = LDL^T$

Quindi:

- L matrice triangolare con diagonale principale che ha tutti 1 (diagonale unitaria)

- D matrice diagonale (tutti 0 tranne sulla diagonale principale)

### Dimostrazione

Dal teorema di fattorizzazione di Gauss sappiamo che A si può fattorizzare come $A = LU$,
inoltre la U ha sulla diagonale principale dei valori che moltiplicati danno il valore di $det(A)$.

$$
D = \begin{pmatrix} u_{11} & \ & \ & 0 \\ \ & u_{22} & \  & \  \\ \ & \  & \ddots  & \  \\ 0 & \  & \  & u_{44}  \\  \end{pmatrix}
$$

Adesso nella relazione $A = LU$ faccio comparire $D$ con l'identità, quindi moltiplico per $DD^{-1}$.

Chiamando $R=D^{-1} U$, è triangolare superiore e ha diagonale unitaria.

Le matrici triangolari formano dei sottogruppi (moltiplicando due matrici diagonali superiori/inferiori
riottengo una matrice diagonale superiore/inferiore).

$D^{-1}$ contiene semplicemente i reciproci degli elementi di D sulla diagonale.

Moltiplicando $D^{-1} U$ succede che avremo una matrice triangolare superiore con diagonale unitaria,
e nelle righe avrò gli elementi precedenti divisi per quello che è nella diagonale.
Cioè $u_{ij} / u_{ii}$ solo per gli $i < j$.

Quindi adesso abbiamo ottenuto che $A = LDR$, ma sappiamo che $A=A^T$ quindi $A^T=(LDR)^T = R^T D L^T$;
sparisce il trasposto su D perché è diagonale, quindi simmetrica.

Possiamo dire che $LDR = R^T D L^T$, moltiplico da entrambi i lati per l'inversa: $LDR(L^T)^{-1} = R^T D L^T (L^T)^{-1}$
così da ottenere l'identità. Poi ho $L^{-1}LDR(L^T)^{-1} = L^{-1} R^T D$.

Alla fine abbiamo: $DR(L^T)^{-1} = L^{-1} R^T D$. Cioè un'uguaglianza tra una matrice triangolare superiore e una inferiore.
Ma allora $DR(L^T)^{-1}$ è diagonale, perciò $R(L^T)^{-1}$ è diagonale.

Sappiamo che l'ultima matrice ha diagonale unitaria dunque $R(L^T)^{-1} = I$. A questo punto $R = L^T$.

## Implementazione

Implicazione: devo calcolare meno elementi. Non uso più l'eliminazione di Gauss.

Si usa il metodo della pavimentazione. Sappiamo già come si decompone la matrice A (in $LDL^T$).

Al primo passo j=1 (colonna) e i=j..n=1 (prima riga):

i = 1 quindi $d_{11} = a_{11}$, mentre per gli i>1 $l_{i1} = a_{i1}/d_{11}$.

Al secondo passo j=2, i=2:

i = 2 abbiamo $a_{22} = d_{22} + d_{11} {l_{21}} ^2 \rightarrow d_{22} = a_{22} - d_{11} {l_{21}} ^2$.

In generale nota la riga i-esima, possiamo trovare la (i+1)-esima.

```pseudocode
for j = 1, ..., n
    d_jj = a_jj - sum(k=1..j-1) l_jk^2 * d_kk
    for i = j + 1, ..., n
        l_ij = (a_ij - sum(k=1..j-1) l_ik * d_kk * l_jk) / d_jj
```

## Complessità

Al passo j effettuo $2(j-1) + (j-1)(n-j)$ prodotti. Questo costo viene affrontanto n
volte perché itero sulle righe. Il costo totale è di O(n^3 / 6), rispetto a Gauss LU risparmiamo
un fattore 2.

Testiamo il metodo in matlab.

## Usi

Adesso sappiamo che possiamo sostituire A con $LDL^T$, per risolvere il sistema posso fare:

$LDL^T x = b \rightarrow Lz = b \rightarrow Dy=z \rightarrow L^T x = y$.

Chiamiamo $DL^T x = z$ e $L^T x = y$.

$Lz$ è un sistema triangolare inferiore: sostituzione in avanti.


$Dy$ è un sistema diagonale, si risolve con n divisioni.

$L^T x$ è un sistema triangolare superiore: sostituzione all'indietro.

Il costo dell'algoritmo di risoluzione è tutto nella risoluzione.
